<h2>group search</h2> 
<ng-container *ngIf="!(loaded$ | async) && !(loading$ | async)">
  <div *ngIf="!groupSize">
    <div class="content-wrapper">
      <p>Let's find your group the perfect costume.</p>
      <p>First, how many people are in your group? 
        <span class="input-wrapper">
          <input type="number" name="quantity" min="1" max="9" (keyup.enter)="next()" [ngClass]="(!groupSizeForm.valid && groupSizeForm.dirty) ? 'error' : ''" [formControl]="groupSizeForm">
          <div *ngIf="!groupSizeForm.valid && groupSizeForm.dirty" class="error-msg">must be 1-9</div>
        </span>
      </p>
      <button (click)="next()" [disabled]="!groupSizeForm.valid" class="next">next</button>
    </div>
  </div>
  <div *ngIf="groupSize" class="groupforms">
    <p>Now tell us about the costumes you're looking for</p>
    <div *ngFor="let costume of group; let i = index" class="costume-form" id="costume-{{i}}">
      <h3>costume {{i + 1}}</h3>
      <button (click)="removeCostume(i)" class="close">X</button>

      <span class="form-body">
        <img src="../../assets/ghost.svg" alt="ghost">

        <form [formGroup]="costume">
          <span>
            <label for="gender-{{i}}">Gender: </label>
            <select id="gender-{{i}}" formControlName="gender">
              <option value="male">Male</option>
              <option value="female">Female</option>
              <option value="">Any</option>
            </select>
  
            <label for="hair-{{i}}">Hair Color: </label>
            <select id="hair-{{i}}" formControlName="hair">
              <option value="blone">Blonde</option>
              <option value="black">Black</option>
              <option value="brown">Brown</option>
              <option value="">Any</option>
            </select>  
          </span>
          
          <span>
            <input type="checkbox" id="hair-{{i}}" formControlName="showAdvanced">  
            <label for="hair-{{i}}">show advanced</label>
          </span>

          <div *ngIf="costume.get('showAdvanced')?.value" >
            <label for="body-{{i}}">body type: </label>
            <select id="body-{{i}}" formControlName="bodyType">
              <option value="any">Any</option>
            </select>

            <label for="ethnicity-{{i}}">ethnicity: </label>
            <select id="ethnicity-{{i}}" formControlName="ethnicity">
              <option value="any">Any</option>
            </select>
          </div>

        </form>
      </span>

    </div>
    <button (click)="addCostume()" class="add">add another <img alt="" src="../../assets/plus.svg"></button>
    <span class="button-wrapper">
      <button (click)="reset()" class="reset">reset</button>
      <button (click)="submit()">submit</button>
    </span>
  </div>
</ng-container>

<ng-container *ngIf="(loading$ | async)">
  LOADING
</ng-container>

<ng-container *ngIf="(loaded$ | async)">
  <ng-container *ngIf="!(error$ | async); else error">
    <span *ngIf="results$ | async as results">
      <span *ngIf="results.length > 0; else noresults">
        YAY RESULTS with LENGTH
        <div *ngFor="let costume of results">
          {{costume.name}}
        </div>
      </span>
    </span>
  </ng-container>
  <button (click)="retry()">retry</button>
</ng-container>

<ng-template #error>
  oops there was an error
</ng-template>

<ng-template #noresults>
  no results for you
</ng-template>